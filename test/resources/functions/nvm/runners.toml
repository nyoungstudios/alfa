[common]
os = "ubuntu-22.04"
image = "phusion/baseimage:jammy-1.0.4"

[case.default]

[case.default.test]

assert-install-names = ["nvm"]
# technically profile should be found when not passing the profile environment variable
assert-log-contains = ["Profile not found."]

[[case.default.test.commands]]

command = "bash"
arguments = ["-ceu", "cat ~/.bashrc"]
assert-stdout-contains = "if"

[[case.default.test.commands]]

command = "bash"
arguments = [
  "-ceu",
  "export NVM_DIR=\"$HOME/.config/nvm\"; export NVM_DIR=\"$HOME/.config/nvm\"; nvm --help",
]
assert-stdout-contains = "Node Version Manager (v0.40.1)"

[case.no-profile]

install-tag = "nvm-no-profile"

[case.no-profile.test]

assert-install-names = ["nvm+no-profile"]
assert-log-contains = ["Profile not found."]

[[case.no-profile.test.commands]]

command = "bash"
arguments = [
  "-ceu",
  "export NVM_DIR=\"$HOME/.config/nvm\"; export NVM_DIR=\"$HOME/.config/nvm\"; nvm --help",
]
assert-stdout-contains = "Node Version Manager (v0.40.1)"
