[common]
os = "ubuntu-22.04"
image = "phusion/baseimage:jammy-1.0.4"

[case.default]

[case.default.test]

assert-install-names = ["nvm"]
# technically profile should be found when not passing the profile environment variable
assert-log-contains = ["Profile not found."]

[[case.default.test.commands]]

command = "bash"
arguments = [
  "-ceux",
  'export NVM_DIR="$HOME/.nvm"; [ -s "$NVM_DIR/nvm.sh" ] && . "$NVM_DIR/nvm.sh"; echo "$NVM_DIR"; ls -alth "$NVM_DIR"; nvm --help',
]
assert-stdout-contains = "Node Version Manager (v0.40.1)"

[case.no-profile]

install-tag = "nvm-no-profile"

[case.no-profile.test]

assert-install-names = ["nvm+no-profile"]
assert-log-contains = ["Profile not found."]

[[case.no-profile.test.commands]]

command = "bash"
arguments = [
  "-ceux",
  'export NVM_DIR="$HOME/.nvm"; [ -s "$NVM_DIR/nvm.sh" ] && . "$NVM_DIR/nvm.sh"; nvm --help',
]
assert-stdout-contains = "Node Version Manager (v0.40.1)"
